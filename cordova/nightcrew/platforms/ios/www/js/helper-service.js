/*

 Helper Service

 */

// Service declarations
function HelperService(){

    // ---
    // parse_and_save(response)
    // pass in a response object { user: {}, session: {} } that is generated by DB
    // this function will store the information locally on the device

    this.parse_and_save = function(response, redirect){
        window.localStorage.setItem("nightcrew_token", response.nightcrew_token);
        window.localStorage.setItem("user_id", response.user.id);
        window.localStorage.setItem("firstname", response.user.firstname);
        window.localStorage.setItem("lastname", response.user.lastname);
        window.localStorage.setItem("email", response.user.email);
        window.localStorage.setItem("gender", response.user.gender);
        window.localStorage.setItem("picture", response.user.picture);
        console.log("HelperService.parse_and_save() - method ran");
        redirect();
    };
    // ---
    
    // ---
    // get_param(param_name)
    // pass in param name as string
    // returns the results
    
    this.get_param = function(variable){
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) {
                return pair[1];
            }
        }
        console.log('HelperService.get_param() - Query Variable ' + variable + ' not found');
    };
    // ---

}

// Load service into app
app.service("HelperService", HelperService);
